management:
    endpoints:
        web:
            exposure:
                include: '*'
            cors:
                allowed-origins: '*'
                allow-credentials: false
opentracing:
    spring:
        web:
            skip-pattern: "/actuator.*|/api-docs.*|/swagger.*|.*\\.png|.*\\.css|.*\\.js|.*\\.html|/favicon.ico|/hystrix.stream"

spring:
    application:
        name: authentication-service

---
spring:
    config:
        activate:
            on-profile: consul
        import: consul:${consul_url:localhost:8500}
    cloud:
        consul:
            config:
                fail-fast: ${FAIL_FAST:true}
                format: yaml
            discovery:
                prefer-ip-address: true
    autoconfigure:
        exclude: org.springframework.cloud.consul.config.ConsulConfigAutoConfiguration
---
spring:
    config:
        activate:
            on-profile: default
    sleuth:
        propagation:
            type:
                - jaeger
                - b3
        otel:
            config:
                trace-id-ratio-based: 1.0
            exporter:
                otlp:
                    endpoint: ${OTLP_ENDPOINT:http://localhost:4317}

---
spring:
    config:
        activate:
            on-profile: dev
    security:
        oauth2:
            client:
                registration:
                    google:
                        client-id: ${CLIENT_ID}
                        client-secret: ${CLIENT_SECRET}
            authorizationserver:
                client:
                    google:
                        registration:
                            client-id: ${CLIENT_ID}
                            client-secret: ${CLIENT_SECRET}
                            client-authentication-methods:
                                - "client_secret_post"
                            authorization-grant-types:
                                - "authorization_code"
                                - "refresh_token"
                            redirect-uris:
                                - "http://127.0.0.1:3000"
                                - "http://127.0.0.1:9999"
                            scopes:
                                - "openid"
                                - "profile"
                                - "email"
                        require-authorization-consent: true
                        require-proof-key: true

---
spring:
    config:
        activate:
            on-profile: prod
    security:
        oauth2:
            client:
                registration:
                    google:
                        client-id: ${CLIENT_ID}
                        client-secret: ${CLIENT_SECRET}
            authorizationserver:
                client:
                    google:
                        registration:
                            client-id: ${CLIENT_ID}
                            client-secret: ${CLIENT_SECRET}
                            client-authentication-methods:
                                - "client_secret_post"
                            authorization-grant-types:
                                - "authorization_code"
                                - "refresh_token"
                            redirect-uris:
                                - "https://spendingbetter.com"
                            scopes:
                                - "openid"
                                - "profile"
                                - "email"
                        require-authorization-consent: true
                        require-proof-key: true
